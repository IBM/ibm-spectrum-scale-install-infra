---
# requirements:
# RHEL 9+ 
# OpenSSL 3+

- name: Check OpenSSL version
  command: openssl version
  register: openssl_version_output
  changed_when: false

# Stop the execution of playbook if required openSSL version not found. 
- fail:
    msg: "OpenSSL version 3 or higher is required for SED support with TPM."
  when: openssl_version_output.stdout is search('OpenSSL\\s([0-2]\\.[0-9]+)')

- name: Check OS version
  command: cat /etc/redhat-release
  register: os_version_output
  changed_when: false

# Stop the execution of playbook if required openSSL version not found. 
- fail:
  msg: "RHEL 9 or higher is required for SED support with TPM."
  when: os_version_output.stdout is search('release\\s([0-8])')