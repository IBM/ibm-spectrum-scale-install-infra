- name: Ensure OpenTSDB Port (HTTP or HTTPs) is set correctly
  replace:
    path: "{{ config_file }}"
    regexp: '^#\s*(port\s*=\s*4242)'
    replace: "port = {{ scale_grafana_bridge.opentsdb_port }}"
  when:
    - config_stat.stat.exists

- name: Ensure Prometheus Port is set correctly
  replace:
    path: "{{ config_file }}"
    regexp: '^#\s*(prometheus\s*=\s*9250)'
    replace: "prometheus = {{ scale_grafana_bridge.prometheus_port }}"
  when:
    - config_stat.stat.exists
