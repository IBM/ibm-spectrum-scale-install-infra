- name: Ensure the .p12 file has 644 permissions
  file: 
    path: "{{ key_protect_cert_files_dir }}/{{ kp_resource_prefix }}.p12"
    mode: '0644'
  delegate_to: localhost
  
- name: Copy the .p12 file to the remote server
  copy:
    src: "{{ key_protect_cert_files_dir }}/{{ kp_resource_prefix }}.p12"
    dest: "/var/mmfs/etc/{{ kp_resource_prefix }}.p12"
    owner: root
    group: root
    mode: '0600'

- name: Ensure the RKM.conf file has 644 permissions
  file: 
    path: "{{ key_protect_cert_files_dir }}/RKM.conf"
    mode: '0644'

- name: Copy RKM.conf to the destination
  copy:
    src: "{{ key_protect_cert_files_dir }}/RKM.conf"
    dest: "/var/mmfs/etc/RKM.conf"
    owner: root
    group: root
    mode: '0600'